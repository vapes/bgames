<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
		<meta name="screen-orientation" content="portrait" />
		<meta name="x5-orientation" content="portrait" />
		<meta name="full-screen" content="yes" />
		<meta name="x5-fullscreen" content="true" />
		<title>Игра подбрасывания монетки</title>
		<style>
			body {
				margin: 0;
				overflow: hidden;
				background: #111;
				font-family: Arial, sans-serif;
			}
			canvas {
				display: block;
			}
			#result {
				position: absolute;
				top: 20px;
				left: 50%;
				transform: translateX(-50%);
				color: white;
				font-size: 3em;
				font-weight: bold;
				text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
				z-index: 100;
				transition: all 0.3s ease;
			}
			#result.edge {
				color: #ffd700;
				font-size: 4em;
			}
			#balance {
				position: absolute;
				top: 20px;
				right: 20px;
				color: #00ff00;
				font-size: 1.5em;
				font-weight: bold;
				z-index: 100;
			}
			#bet-info {
				position: absolute;
				top: 60px;
				right: 20px;
				color: #ffff00;
				font-size: 1.2em;
				z-index: 100;
			}
			#payout-info {
				position: absolute;
				top: 100px;
				right: 20px;
				color: #cccccc;
				font-size: 1em;
				z-index: 100;
			}
			#instructions {
				position: absolute;
				bottom: 20px;
				left: 50%;
				transform: translateX(-50%);
				color: #ccc;
				font-size: 1.2em;
				text-align: center;
				z-index: 100;
			}

			/* Мобильные устройства */
			@media (max-width: 768px) {
				#result {
					font-size: 2em;
					top: 10px;
				}
				#result.edge {
					font-size: 2.5em;
				}
				#balance {
					font-size: 1.2em;
					top: 10px;
					right: 10px;
				}
				#bet-info {
					font-size: 1em;
					top: 40px;
					right: 10px;
				}
				#payout-info {
					font-size: 0.8em;
					top: 70px;
					right: 10px;
				}
				#instructions {
					font-size: 1em;
					bottom: 10px;
					padding: 0 10px;
				}
			}

			/* Портретный режим на мобильных */
			@media (max-width: 768px) and (orientation: portrait) {
				#result {
					font-size: 1.5em;
					top: 5px;
				}
				#result.edge {
					font-size: 2em;
				}
				#balance {
					font-size: 1em;
					top: 5px;
					right: 5px;
				}
				#bet-info {
					font-size: 0.9em;
					top: 30px;
					right: 5px;
				}
				#payout-info {
					font-size: 0.7em;
					top: 55px;
					right: 5px;
				}
				#instructions {
					font-size: 0.9em;
					bottom: 5px;
					padding: 0 5px;
				}
			}

			/* Кнопки теперь создаются в Three.js */

			/* Принудительная портретная ориентация только для мобильных */
			@media screen and (orientation: landscape) and (max-width: 768px) {
				body {
					transform: rotate(90deg);
					transform-origin: center center;
					width: 100vh;
					height: 100vw;
					overflow: hidden;
				}
			}
		</style>
		<script>
			// Автоматический полноэкранный режим только на мобильных устройствах
			let fullscreenRequested = false;

			// Определяем Android устройство
			function isAndroidDevice() {
				const isAndroid = /Android/i.test(navigator.userAgent);

				if (isAndroid) {
					console.log('Игра запущена на Android устройстве');
					console.log('User-Agent:', navigator.userAgent);
					console.log('Размер экрана:', window.innerWidth + 'x' + window.innerHeight);
				} else {
					console.log('Игра запущена не на Android устройстве');
				}

				return isAndroid;
			}

			function requestFullscreen() {
				if (fullscreenRequested || !isAndroidDevice()) return;
				fullscreenRequested = true;

				const elem = document.documentElement;

				try {
					if (elem.requestFullscreen) {
						elem.requestFullscreen().catch((err) => {
							console.log('Полноэкранный режим не поддерживается или заблокирован:', err);
						});
					} else if (elem.webkitRequestFullscreen) {
						elem.webkitRequestFullscreen().catch((err) => {
							console.log('Полноэкранный режим не поддерживается или заблокирован:', err);
						});
					} else if (elem.msRequestFullscreen) {
						elem.msRequestFullscreen().catch((err) => {
							console.log('Полноэкранный режим не поддерживается или заблокирован:', err);
						});
					} else {
						console.log('Полноэкранный режим не поддерживается в этом браузере');
					}
				} catch (error) {
					console.log('Ошибка при запросе полноэкранного режима:', error);
				}
			}

			// Глобальная переменная для отслеживания первого нажатия на кнопку
			let firstButtonClick = false;

			// Функция для запроса полноэкранного режима при первом нажатии на кнопку
			function requestFullscreenOnButtonClick() {
				if (fullscreenRequested || !isAndroidDevice() || firstButtonClick) {
					return;
				}

				firstButtonClick = true;
				fullscreenRequested = true;

				const elem = document.documentElement;

				try {
					if (elem.requestFullscreen) {
						elem.requestFullscreen().catch(() => {
							// Игнорируем ошибки полноэкранного режима
						});
					} else if (elem.webkitRequestFullscreen) {
						elem.webkitRequestFullscreen().catch(() => {
							// Игнорируем ошибки полноэкранного режима
						});
					} else if (elem.msRequestFullscreen) {
						elem.msRequestFullscreen().catch(() => {
							// Игнорируем ошибки полноэкранного режима
						});
					}
				} catch (error) {
					// Игнорируем ошибки полноэкранного режима
				}
			}

			// Экспортируем функцию для использования в Three.js
			window.requestFullscreenOnButtonClick = requestFullscreenOnButtonClick;

			// Принудительно блокируем ориентацию в портретном режиме только на мобильных
			if (window.innerWidth <= 768 && screen.orientation && screen.orientation.lock) {
				screen.orientation.lock('portrait').catch(() => {
					// Игнорируем ошибки блокировки ориентации
				});
			}
		</script>
		<script type="module" crossorigin src="./assets/index.js"></script>
	</head>
	<body>
		<div id="result"></div>
		<div id="balance">Баланс: 1000</div>
		<div id="bet-info">Ставка: 10</div>
		<div id="payout-info">
			Выплаты:<br />
			Орёл/Решка: x1.98<br />
			Ребро: x48.5
		</div>
		<!-- Кнопки теперь создаются в Three.js -->
		<div id="instructions">Сделайте ставку и подбросьте монетку!</div>
	</body>
</html>
